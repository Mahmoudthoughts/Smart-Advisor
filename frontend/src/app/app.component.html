<header class="topbar">
  <a class="brand" [routerLink]="brandTarget()">{{ brand }}</a>
  <nav *ngIf="isAuthenticated()">
    <button type="button" class="menu-toggle" (click)="toggleMenu($event)" aria-haspopup="true" [attr.aria-expanded]="menuOpen()">
      Menu
      <span class="chevron" [class.open]="menuOpen()">▾</span>
    </button>
    <div class="nav-menu" *ngIf="menuOpen()" (click)="keepMenuOpen($event)">
      <header>
        <h3>Choose pages</h3>
        <p>Select which views appear in your quick navigation.</p>
      </header>
      <ul>
        <li *ngFor="let link of allNavLinks">
          <label>
            <input type="checkbox" [checked]="isLinkSelected(link.path)" (change)="toggleLink(link.path)" />
            <span>{{ link.label }}</span>
          </label>
        </li>
      </ul>
      <footer class="menu-actions">
        <button type="button" class="link" (click)="selectAll()">Select all</button>
        <button type="button" class="link" (click)="resetDefaults()">Reset defaults</button>
      </footer>
    </div>
    <a
      *ngFor="let link of navLinks()"
      [routerLink]="link.path"
      routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: false }"
      >{{ link.label }}</a
    >
  </nav>
  <div class="session">
    <ng-container *ngIf="isAuthenticated(); else loginLink">
      <div class="user-chip" aria-label="Signed in user">
        <span class="avatar" aria-hidden="true">{{ userInitials() }}</span>
        <span class="user-name">{{ user()?.name }}</span>
      </div>
      <button type="button" class="signout" (click)="logout()">Sign out</button>
    </ng-container>
    <ng-template #loginLink>
      <a routerLink="/login" class="login">Login</a>
      <a routerLink="/register" class="register">Register</a>
    </ng-template>
  </div>
</header>

<main class="app-shell">
  <router-outlet></router-outlet>
</main>

<footer class="footer">
  <p>© {{ currentYear }} Smart Advisor. Missed opportunity analytics, elevated.</p>
</footer>
