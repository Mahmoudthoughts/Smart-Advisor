<section class="signals-page">
  <header class="page-header">
    <h1>Signals & Rules</h1>
    <p>Review triggered signals, manage boolean rules, and control cooldown policies.</p>
  </header>

  <section class="rules">
    <header>
      <h2>Rule library</h2>
      <p>Active rules evaluate on nightly batch; drafts can be staged for review.</p>
    </header>
    <ul>
      <li *ngFor="let rule of rules" [class.draft]="rule.status === 'draft'">
        <div class="rule-header">
          <h3>{{ rule.label }}</h3>
          <span class="status">{{ rule.status }}</span>
        </div>
        <p>{{ rule.description }}</p>
        <footer>
          <span>Rule ID: {{ rule.id }}</span>
          <span>Cooldown: {{ rule.cooldownDays }} day(s)</span>
        </footer>
      </li>
    </ul>
  </section>

  <section class="events">
    <header>
      <h2>Recent signal events</h2>
      <p>Deduplicated daily triggers with severity context and reasoning snippets.</p>
    </header>
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Symbol</th>
          <th>Signal</th>
          <th>Severity</th>
          <th>Context</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let event of events">
          <td>{{ event.date }}</td>
          <td><span class="ticker">{{ event.symbol }}</span></td>
          <td>{{ event.signalType }}</td>
          <td><span class="badge" [class.action]="event.severity === 'action'" [class.watch]="event.severity === 'watch'">{{ event.severity }}</span></td>
          <td>{{ event.context }}</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section class="form-card">
    <header>
      <h2>Quick rule prototype</h2>
      <p>Sketch a boolean expression; backend will convert to JSON tree per ยง7.3.</p>
    </header>
    <form>
      <label>
        Symbol
        <input type="text" [ngModel]="ruleForm().symbol" name="symbol" (ngModelChange)="updateForm('symbol', $event)" />
      </label>
      <label>
        Condition expression
        <textarea
          name="condition"
          rows="3"
          [ngModel]="ruleForm().condition"
          (ngModelChange)="updateForm('condition', $event)"
        ></textarea>
      </label>
      <div class="inline">
        <label>
          Cooldown (days)
          <input
            type="number"
            min="0"
            [ngModel]="ruleForm().cooldown"
            name="cooldown"
            (ngModelChange)="updateForm('cooldown', $event)"
          />
        </label>
        <label>
          Severity
          <select [ngModel]="ruleForm().severity" name="severity" (ngModelChange)="updateForm('severity', $event)">
            <option value="info">Info</option>
            <option value="watch">Watch</option>
            <option value="action">Action</option>
          </select>
        </label>
      </div>
      <button type="button">Save draft</button>
    </form>
  </section>
</section>
